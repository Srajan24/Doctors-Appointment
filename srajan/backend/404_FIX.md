# Fixing 404 NOT_FOUND Error - Step by Step

## ğŸš¨ You're Getting 404 - Here's How to Fix It

The 404 error means Vercel cannot find your serverless function. Follow these steps in order:

---

## âœ… Step 1: Verify File Structure (CRITICAL)

Your backend must have this exact structure:

```
srajan/backend/
  â”œâ”€â”€ api/
  â”‚   â””â”€â”€ index.js          â† MUST EXIST
  â”œâ”€â”€ index.js              
  â”œâ”€â”€ vercel.json           
  â””â”€â”€ package.json          
```

**Check if `api/index.js` exists:**
```bash
cd srajan/backend
dir api\index.js
# Should show the file exists
```

**If missing, create it:**
```javascript
// srajan/backend/api/index.js
import app from '../index.js';
export default app;
```

---

## âœ… Step 2: Verify api/index.js Content

The file must export the Express app directly:

**âœ… CORRECT:**
```javascript
import app from '../index.js';
export default app;
```

**âŒ WRONG:**
```javascript
// Don't wrap in a function
export default function handler(req, res) {
  return app(req, res);
}

// Don't forget export
import app from '../index.js';
// Missing: export default app;
```

---

## âœ… Step 3: Check Vercel Dashboard Settings (MOST COMMON FIX)

**This fixes 90% of 404 errors!**

1. Go to [Vercel Dashboard](https://vercel.com/dashboard)
2. Select your project
3. Go to **Settings** â†’ **General**
4. Scroll to **Root Directory**

### Fix Root Directory
- **Current:** Probably empty or wrong
- **Change to:** `srajan/backend`
- Click **Save**
- **Redeploy** (trigger a new deployment)

### Fix Output Directory
- Go to **Build & Development Settings**
- Find **Output Directory**
- **MUST BE EMPTY** (leave blank, don't enter anything)
- If it has a value (like `dist` or `build`), delete it
- Click **Save**
- **Redeploy**

---

## âœ… Step 4: Verify vercel.json

Your `srajan/backend/vercel.json` should look exactly like this:

```json
{
  "version": 2,
  "builds": [
    {
      "src": "api/index.js",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "/api/index.js"
    }
  ],
  "functions": {
    "api/index.js": {
      "maxDuration": 30
    }
  }
}
```

**Key points:**
- `builds` section tells Vercel to build `api/index.js` as a function
- `routes` section routes ALL requests to `/api/index.js`
- `functions` section sets timeout

---

## âœ… Step 5: Check for Conflicting Files

**Problem:** Multiple `vercel.json` files can confuse Vercel

### Check Root-Level vercel.json

At repository root: `srajan/vercel.json`

**If it exists and has routing configuration, it might conflict.**

**Fix:**
- Either delete it, OR
- Make sure it only contains a comment (not actual config)

**Your current `srajan/vercel.json` should be:**
```json
{
  "comment": "This file should not be used if deploying backend separately. Delete this file or ensure Vercel project root is set to 'srajan/backend'"
}
```

This is safe (it's just a comment), but if you want to be extra safe, delete it.

---

## âœ… Step 6: Verify Deployment

After making changes:

1. **Go to Vercel Dashboard** â†’ Your Project â†’ **Deployments**
2. **Trigger a new deployment:**
   - Either push to Git (if connected)
   - Or click **Redeploy** on latest deployment
3. **Wait for deployment to complete**
4. **Check deployment status:**
   - Should be "Ready" (green checkmark)
   - If "Error" or "Failed" â†’ Check Build Logs

---

## âœ… Step 7: Test the Fix

After deployment completes:

### Test Root Endpoint
```
https://your-project.vercel.app/
```

**Expected Response:**
```
Backend is running ğŸš€
```

### Test API Endpoint
```
https://your-project.vercel.app/api/user
```

**Expected:**
- Either returns data
- Or returns error response (NOT 404)

**If still 404:**
- Wait 1-2 minutes (sometimes takes time to propagate)
- Check if you're using the correct URL
- Check Functions tab in Vercel dashboard

---

## ğŸ” Step 8: Verify Function Exists

1. Go to Vercel Dashboard â†’ Your Deployment
2. Click **Functions** tab
3. Look for `api/index.js` in the list

**If you see `api/index.js`:**
- âœ… Function exists
- Check function logs for runtime errors

**If you DON'T see `api/index.js`:**
- âŒ Root Directory is wrong
- âŒ `api/index.js` doesn't exist
- âŒ Build failed

---

## ğŸ“‹ Quick Checklist

Run through this checklist - all must be âœ…:

- [ ] `srajan/backend/api/index.js` exists
- [ ] `api/index.js` exports: `export default app;`
- [ ] `srajan/backend/vercel.json` exists and is correct
- [ ] Vercel Root Directory set to `srajan/backend`
- [ ] Vercel Output Directory is **EMPTY**
- [ ] Latest deployment status is "Ready"
- [ ] Function `api/index.js` appears in Functions tab
- [ ] Test URL: `https://your-app.vercel.app/` returns response (not 404)

---

## ğŸ¯ Most Likely Cause (90% of cases)

**Wrong Root Directory**

If Vercel Root Directory is NOT set to `srajan/backend`:
- Vercel looks for `api/index.js` in the wrong place
- Can't find it â†’ 404 error

**Fix:**
1. Vercel Dashboard â†’ Settings â†’ General
2. Root Directory â†’ Set to `srajan/backend`
3. Save â†’ Redeploy

---

## ğŸ†˜ Still Getting 404?

### Diagnostic Steps:

1. **Check Build Logs**
   - Deployment â†’ Build Logs
   - Look for: "Building api/index.js"
   - If missing, build failed

2. **Check Function Logs**
   - Deployment â†’ Functions â†’ api/index.js â†’ Logs
   - Make a test request
   - Check for errors

3. **Verify File Path**
   ```bash
   # From repository root
   cat srajan/backend/api/index.js
   # Should show the file content
   ```

4. **Check Deployment Root**
   - In Vercel Dashboard, verify which directory is being deployed
   - Should show files from `srajan/backend/` not root

5. **Try Manual Test**
   - Deploy using Vercel CLI:
   ```bash
   cd srajan/backend
   vercel --prod
   ```
   - This shows detailed output and errors

---

## ğŸ’¡ Understanding Why 404 Happens

**Traditional Server:**
```
Request â†’ Server Process (always running) â†’ Express App â†’ Response
```

**Vercel Serverless:**
```
Request â†’ Vercel Platform â†’ Looks for function handler â†’ Finds api/index.js â†’ Executes â†’ Response
                                     â†‘
                            If can't find â†’ 404
```

**Why it can't find:**
1. Root Directory wrong â†’ Looking in wrong location
2. `api/index.js` missing â†’ Handler doesn't exist
3. Wrong export â†’ Vercel can't use it as handler
4. Output Directory set â†’ Vercel thinks it's static files, not functions

---

## âœ… After Fix - Verification

Once fixed, you should see:

1. **Deployment succeeds** (green checkmark)
2. **Function appears** in Functions tab (`api/index.js`)
3. **Root endpoint works:** `https://your-app.vercel.app/` â†’ "Backend is running ğŸš€"
4. **API endpoints work:** `https://your-app.vercel.app/api/user` â†’ Returns data or error (not 404)

---

*Fix the Root Directory first - that's the #1 cause of 404 errors!*

